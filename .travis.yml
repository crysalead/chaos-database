language: php

php:
  - 5.5
  - 5.6
  - 7.0
  - hhvm

matrix:
  fast_finish: true
  allow_failures:
    - php: 7.0

before_script:
  - mysql -e 'create database chaos_test;'
  - psql -c 'create database chaos_test;' -U postgres
  - composer config -g github-oauth.github.com $GITHUB_COMPOSER_AUTH
  - composer self-update
  - composer install --no-interaction
  - if [[ $TRAVIS_PHP_VERSION =~ ^hhvm ]]; then echo 'xdebug.enable = On' >> /etc/hhvm/php.ini; fi

script: bin/kahlan --config=kahlan-config.travis.php --clover=clover.xml

after_success:
  - "if [ $(phpenv version-name) = '5.6' ]; then wget https://scrutinizer-ci.com/ocular.phar; fi"
  - "if [ $(phpenv version-name) = '5.6' ]; then php ocular.phar code-coverage:upload --format=php-clover 'clover.xml'; fi"

env:
  global:
  - secure: mxKxZwa13pYZNldWRl8IzNxdr2iOOhjQnXuHJK8eL7iljdZ7+rMNdxGEyCjcXpXiN4UFG1eYZSBhQ31ceHhc9G0uNuNKWvduD3WhYHwuAn6EkSizDxMo1BQlN8/JciGyHrn6TFy0Lq69IV3wcpl43dJ9HqvdtePVWH+sg5m0vIeCfp+UCLyGXrde0z/+94j3sxwCKNyUZkQmUwJoZeesHQB5iXCkpucEgFxhIKsObhHZ1b1k2ClUvaScaIiDxH/v7ajICouVaMgNT4HNUfU2vgLA+wvwBj5PgqVhSgacg+CyJvQh1hPkIBVTJynZ0LvmhambPgwYEFUAlNSo/4mrurUmoJkxiiGXNOtxAIRVdmr4eStpM8DudgketJ84P4MDs7Z7xU5rSxYDDSBPGDAlLt1H4SPoho7TU/uJldsKjKA8iQ0jClyhARIhDGETS/p61f7glH4CxhNhA8W46AJuv1r4wqj1R3RhNd/pd/+SfuCUyeHqmijHBCLNcDZssPODfal6plgkvEUXdlv5bAbbGramWh1QU7cklk2v/mOHPLEClVO4OFkqZRSB5zlyyRYV4/ew0z5jikJAODX9OzKz2IrJRx+j6xChZQ0JcF3g6xFV0R7TxDzcGyfjp4hmCxQ9OJCk5WB/d8bbk1tMGq5zpMmZ8tVCyHGvsZ2GCYpwgWI=
